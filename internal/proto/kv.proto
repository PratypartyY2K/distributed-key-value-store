syntax = "proto3";

package kv;

service ReplicaService {
  rpc Read(ReadRequest) returns (ReadReply);
  rpc Write(WriteRequest) returns (WriteReply);
  rpc Lock(LockRequest) returns (LockReply);   // For blocking protocol
  rpc Unlock(UnlockRequest) returns (UnlockReply);
}

message ReadRequest {}

message ReadReply {
  string value = 1;
  int64 timestamp = 2;
  string writer_id = 3;
}

message WriteRequest {
  string value = 1;
  int64 timestamp = 2;
  string writer_id = 3;
}

message WriteReply {
  bool success = 1;
}

message LockRequest {
  string client_id = 1;
}

message LockReply {
  bool granted = 1;
}

message UnlockRequest {
  string client_id = 1;
}

message UnlockReply {
  bool success = 1;
}
